{% extends "base/base.html" %}
{% load static %}

{% block title %}Turf Owner Dashboard | TurfBooking{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-logo">
            ‚öΩ TurfBooking
        </div>

     <nav class="sidebar-nav">
    <a href="{% url 'turf_dashboard' %}?tab=dashboard"
       class="{% if tab == 'dashboard' %}active{% endif %}">
        üè† Dashboard
    </a>

    <a href="{% url 'turf_dashboard' %}?tab=turfs"
       class="{% if tab == 'turfs' %}active{% endif %}">
        üèü My Turfs
    </a>

    <a href="{% url 'turf_dashboard' %}?tab=bookings"
       class="{% if tab == 'bookings' %}active{% endif %}">
        üìÖ Bookings
    </a>

    <a href="{% url 'logout' %}" class="logout">üö™ Logout</a>
</nav>
    </aside>

    <main class="dashboard-main">

    <!-- ================= DASHBOARD ================= -->
    <section class="dashboard-section {% if tab == 'dashboard' %}active{% endif %}">

        <div class="dashboard-header">
            <div>
                <h1>Turf Owner Dashboard</h1>
                <p>Welcome back, <strong>{{ request.user.username }}</strong></p>
            </div>

            <a href="{% url 'add_turf' %}" class="primary-btn">
                + Add New Turf
            </a>
        </div>

        <div class="overview">
            <div class="overview-card">
                <h2>{{ turfs|length }}</h2>
                <p>Total Turfs</p>
            </div>

            <div class="overview-card">
                <h2>{{ bookings|length }}</h2>
                <p>Total Bookings</p>
            </div>

            <div class="overview-card success">
                <h2>{{ bookings|length }}</h2>
                <p>Confirmed</p>
            </div>
        </div>

        <h2>My Turfs</h2>
        <div class="card-grid">
            {% for turf in turfs %}
            <div class="card">
                <h3>{{ turf.name }}</h3>
                <p>üìç {{ turf.location.name }} ({{ turf.location.district.name }})</p>
                <span class="badge active">Active</span>
                <a href="{% url 'add_slot' turf.id %}" class="link">Add Slots ‚Üí</a>
            </div>
            {% endfor %}
        </div>
    </section>

    <!-- ================= MY TURFS ================= -->
    <section class="dashboard-section {% if tab == 'turfs' %}active{% endif %}">
        <h2>My Turfs</h2>

        <table class="data-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Location</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for turf in turfs %}
                <tr>
                    <td>{{ turf.name }}</td>
                    <td>{{ turf.location.name }} ({{ turf.location.district.name }})</td>
                    <td><span class="status active">Active</span></td>
                    <td>
                        <a href="{% url 'add_slot' turf.id %}">Add Slots</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>

    <!-- ================= BOOKINGS ================= -->
    <section class="dashboard-section {% if tab == 'bookings' %}active{% endif %}">
        <h2>Bookings</h2>

        {% if bookings %}
        <table class="data-table">
            <thead>
                <tr>
                    <th>User</th>
                    <th>Turf</th>
                    <th>Slot</th>
                    <th>Date</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for booking in bookings %}
                <tr>
                    <td>{{ booking.user.username }}</td>
                    <td>{{ booking.slot.turf.name }}</td>
                    <td>{{ booking.slot.start_time }} - {{ booking.slot.end_time }}</td>
                    <td>{{ booking.date }}</td>
                    <td><span class="badge success">{{ booking.status }}</span></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>No bookings yet.</p>
        {% endif %}
    </section>

</main>
</div>

<!-- ================= JS ================= -->
<script>
function showSection(section, el) {
    // hide all sections
    document.querySelectorAll('.dashboard-section').forEach(sec => {
        sec.classList.remove('active');
    });

    // remove active class from links
    document.querySelectorAll('.sidebar-nav a').forEach(link => {
        link.classList.remove('active');
    });

    // show selected section
    document.getElementById(section + '-section').classList.add('active');
    el.classList.add('active');
}
</script>

{% endblock %}